(function(t){function e(e){for(var n,r,o=e[0],c=e[1],h=e[2],u=0,d=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(d.length)d.shift()();return a.push.apply(a,h||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,o=1;o<i.length;o++){var c=i[o];0!==s[c]&&(n=!1)}n&&(a.splice(e--,1),t=r(r.s=i[0]))}return t}var n={},s={app:0},a=[];function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var h=0;h<o.length;h++)e(o[h]);var l=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},1:function(t,e){},"1bda":function(t,e,i){"use strict";i("eb5e")},2:function(t,e){},2259:function(t,e,i){},"2ca0":function(t,e){!function(t){var e,i,n,s,a,r,o='<svg><symbol id="icon-wenzi" viewBox="0 0 1024 1024"><path d="M837.313 220.438H186.688c-18.563 0-33.75-15.188-33.75-33.75s15.187-33.75 33.75-33.75h650.625c18.562 0 33.75 15.187 33.75 33.75s-15.188 33.75-33.75 33.75z"  ></path><path d="M478.25 837.313V186.688c0-18.563 15.188-33.75 33.75-33.75s33.75 15.187 33.75 33.75v650.625c0 18.562-15.188 33.75-33.75 33.75s-33.75-15.188-33.75-33.75z"  ></path></symbol><symbol id="icon-guanbi" viewBox="0 0 1024 1024"><path d="M544.00976563 504.16894531L798.32128906 249.64648437a26.34082031 26.34082031 0 1 0-37.28320312-37.28320312L506.75292969 466.88574219 252.44140625 212.33691406a26.34082031 26.34082031 0 1 0-37.28320313 37.28320313l254.31152344 254.52246093-254.31152343 254.52246094a26.34082031 26.34082031 0 1 0 37.28320312 37.28320313l254.31152344-254.52246094L761.03808594 795.94824219a26.34082031 26.34082031 0 1 0 37.28320312-37.28320313l-254.31152343-254.49609375z"  ></path></symbol><symbol id="icon-fangda" viewBox="0 0 1024 1024"><path d="M847.57519531 836.6328125L733.11523438 722.17285156C791.99316406 660.57910156 828.40625 577.36425781 828.40625 485.6328125c0-189-153.7734375-342.7734375-342.7734375-342.7734375S142.859375 296.6328125 142.859375 485.6328125s153.7734375 342.7734375 342.7734375 342.7734375c78.28417969 0 150.31933594-26.68359375 208.08984375-71.03320313l116.54296875 116.54296876a26.28808594 26.28808594 0 0 0 37.28320313 0 26.3671875 26.3671875 0 0 0 0.02636718-37.28320313zM195.59375 485.6328125c0-159.91699219 130.12207031-290.0390625 290.0390625-290.0390625s290.0390625 130.12207031 290.0390625 290.0390625-130.12207031 290.0390625-290.0390625 290.0390625-290.0390625-130.12207031-290.0390625-290.0390625z"  ></path><path d="M605.76171875 459.265625H512V366.98046875a26.3671875 26.3671875 0 0 0-52.734375 0v92.28515625H366.98046875a26.3671875 26.3671875 0 0 0 0 52.734375h92.28515625v92.28515625a26.3671875 26.3671875 0 1 0 52.734375 0V512h93.76171875a26.3671875 26.3671875 0 1 0 0-52.734375z"  ></path></symbol><symbol id="icon-duigou" viewBox="0 0 1024 1024"><path d="M912.65 237.23a30 30 0 0 1 42.99 41.88l-504.39 517.5a30 30 0 0 1-41.04 1.8L91.88 525.17a30 30 0 1 1 39.09-45.51L427.94 734.6 912.65 237.2z"  ></path></symbol><symbol id="icon-juxing" viewBox="0 0 1024 1024"><path d="M806.072 133.908a84.02 84.02 0 0 1 84.02 84.02v588.144a84.02 84.02 0 0 1-84.02 84.02H217.928a84.02 84.02 0 0 1-84.02-84.02V217.928a84.02 84.02 0 0 1 84.02-84.02h588.144z m0 33.608H217.928a50.412 50.412 0 0 0-50.16 45.245l-0.252 5.167v588.144a50.412 50.412 0 0 0 45.245 50.16l5.167 0.252h588.144a50.412 50.412 0 0 0 50.16-45.245l0.252-5.167V217.928a50.412 50.412 0 0 0-45.245-50.16l-5.167-0.252z"  ></path></symbol><symbol id="icon-suoxiao" viewBox="0 0 1024 1024"><path d="M847.57519531 836.6328125L733.11523438 722.17285156C791.99316406 660.57910156 828.40625 577.36425781 828.40625 485.6328125c0-189-153.7734375-342.7734375-342.7734375-342.7734375S142.859375 296.6328125 142.859375 485.6328125s153.7734375 342.7734375 342.7734375 342.7734375c78.28417969 0 150.31933594-26.68359375 208.08984375-71.03320313l116.54296875 116.54296876a26.28808594 26.28808594 0 0 0 37.28320313 0 26.3671875 26.3671875 0 0 0 0.02636718-37.28320313zM195.59375 485.6328125c0-159.91699219 130.12207031-290.0390625 290.0390625-290.0390625s290.0390625 130.12207031 290.0390625 290.0390625-130.12207031 290.0390625-290.0390625 290.0390625-290.0390625-130.12207031-290.0390625-290.0390625z"  ></path><path d="M605.76171875 459.265625H366.98046875a26.3671875 26.3671875 0 0 0 0 52.734375h238.78125a26.3671875 26.3671875 0 1 0 0-52.734375z"  ></path></symbol><symbol id="icon-huabi" viewBox="0 0 1024 1024"><path d="M716.567 401.106L364.71 820.448a14.58 14.58 0 0 1-6.613 4.46l-106.544 35.33a14.602 14.602 0 0 1-19.085-15.978l16.288-111.071a14.558 14.558 0 0 1 3.263-7.28l351.877-419.341a14.625 14.625 0 0 1 20.595-1.798l90.277 75.742a14.625 14.625 0 0 1 1.798 20.594zM832.63 262.783l-51.397 61.25a14.625 14.625 0 0 1-20.616 1.82l-90.277-75.764a14.625 14.625 0 0 1-1.776-20.594l51.397-61.25a14.625 14.625 0 0 1 20.594-1.82l90.278 75.764c6.191 5.17 6.99 14.402 1.797 20.594z"  ></path></symbol><symbol id="icon-chexiao" viewBox="0 0 1024 1024"><path d="M672.704 843.37h-416c-17.68 0-32-14.335-32-32 0-17.68 14.32-32 32-32h416c106.032 0 192-85.967 192-192 0-106.047-85.968-192-192-192H202.16l139.632 139.44c11.984 11.969 11.984 31.377 0 43.345-12 11.984-31.456 11.984-43.44 0L104 384.09c-11.984-11.968-11.984-31.392 0-43.36l194.352-194.08c11.984-11.968 31.44-11.968 43.44 0 11.984 11.984 11.984 31.392 0 43.36L200.24 331.37h472.464c141.376 0 256 114.608 256 256 0 141.376-114.624 256-256 256z"  ></path></symbol><symbol id="icon-tuoyuan" viewBox="0 0 1024 1024"><path d="M512.7 871C394.4 871 283 834.2 199 767.3c-41.3-32.8-73.8-71.2-96.5-114-23.8-44.7-35.9-92.2-35.9-141.3s12.1-96.6 35.8-141.3c22.8-42.8 55.2-81.1 96.5-114 84-66.8 195.4-103.6 313.8-103.6s229.7 36.8 313.8 103.6c41.3 32.8 73.8 71.2 96.5 114 23.8 44.7 35.8 92.3 35.8 141.3s-12.1 96.6-35.8 141.3c-22.8 42.8-55.2 81.1-96.5 114C742.5 834.2 631 871 512.7 871z m0-677.9c-223.9 0-406.1 143.1-406.1 318.9s182.2 319 406.1 319c223.9 0 406.1-143.1 406.1-318.9s-182.1-319-406.1-319z"  ></path></symbol></svg>',c=(c=document.getElementsByTagName("script"))[c.length-1].getAttribute("data-injectcss");if(c&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}function h(){a||(a=!0,n())}e=function(){var t,e,i;(i=document.createElement("div")).innerHTML=o,o=null,(e=i.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",t=e,(i=document.body).firstChild?(e=i.firstChild).parentNode.insertBefore(t,e):i.appendChild(t))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(e,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),e()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(n=e,s=t.document,a=!1,(r=function(){try{s.documentElement.doScroll("left")}catch(t){return void setTimeout(r,50)}h()})(),s.onreadystatechange=function(){"complete"==s.readyState&&(s.onreadystatechange=null,h())})}(window)},3:function(t,e){},"3ad9":function(t,e,i){},4421:function(t,e,i){},4894:function(t,e,i){"use strict";i.r(e);var n=i("2259");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s)},"48f9":function(t,e,i){"use strict";i.r(e);var n=i("3ad9");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s)},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("button",{on:{click:t.handleOpenDrawer}},[t._v("打开图片")]),i("ImageDrawer",{ref:"refImageDrawer",on:{onSave:t.handleSave}})],1)},a=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.visible?i("div",{staticClass:"imgdw-wrapper"},[t.size?i("div",{staticClass:"imgdw-canvas-wrapper",style:{width:t.size.width+"px",height:t.size.height+"px",transform:"translate(-50%, -50%) scale("+t.canvasScale+")"}},[i("img",{staticClass:"imgdw-imgbg",attrs:{src:t.imgBase64}}),i("canvas",{ref:"canvas",attrs:{width:t.size.width,height:t.size.height}})]):t._e(),i("Toolbar",{ref:"toolbar",attrs:{curBrush:t.curBrush,canvasScale:t.canvasScale},on:{onSelectBrush:t.handleSelectBrush,onUndo:t.handleUndo,onScale:t.handleScale,onCancel:t.handleCancel,onConfirm:t.handleConfirm}})],1):t._e()},o=[],c=i("1da1"),h=(i("96cf"),i("ade3")),l=i("7a94"),u={strokeWidth:3,strokeColor:"#f00",fillColor:"transparent",fontsize:30,canvas:{selectionColor:"transparent",selectionFullyContained:!0},rect:{selectable:!0,strokeUniform:!0},circle:{selectable:!0,strokeUniform:!0},text:{selectable:!0,strokeUniform:!0},line:{selectable:!0,strokeUniform:!0},controls:{transparentCorners:!1,hasBorders:!1,cornerStyle:"circle",padding:-2,cornerSize:8,cornerColor:"#fff",cornerStrokeColor:"#f00",borderOpacityWhenMoving:1}};class d{constructor(t,e){Object(h["a"])(this,"isDrawing",!1),Object(h["a"])(this,"strokeWidth",u.strokeWidth),Object(h["a"])(this,"strokeColor",u.strokeColor),Object(h["a"])(this,"fillColor",u.fillColor),Object(h["a"])(this,"init",()=>this.initEvent()),Object(h["a"])(this,"initEvent",()=>(this.canvas.on("mouse:down",this.onMouseDown),this.canvas.on("mouse:move",this.onMouseMove),this.canvas.on("mouse:up",this.onMouseUp),()=>{this.canvas.off("mouse:down",this.onMouseDown),this.canvas.off("mouse:move",this.onMouseMove),this.canvas.off("mouse:up",this.onMouseUp)})),Object(h["a"])(this,"onMouseDown",t=>{if(t.target)return;this.isDrawing=!0;let e=this.canvas.getPointer(t.e);this.startX=e.x,this.startY=e.y;let i=new l["fabric"].Rect({...u.rect,...u.controls,left:this.startX,top:this.startY,originX:"left",originY:"top",width:e.x-this.startX,height:e.y-this.startY,stroke:this.strokeColor,strokeWidth:this.strokeWidth,fill:this.fillColor});i.setControlVisible("mtr",!1),this.canvas.add(i),this.curRect=i}),Object(h["a"])(this,"onMouseMove",t=>{if(!this.isDrawing)return;let e=this.canvas.getPointer(t.e);this.startX>e.x&&this.curRect.set({left:Math.abs(e.x)}),this.startY>e.y&&this.curRect.set({top:Math.abs(e.y)}),this.curRect.set({width:Math.abs(this.startX-e.x)}),this.curRect.set({height:Math.abs(this.startY-e.y)}),this.curRect.setCoords(),this.canvas.renderAll()}),Object(h["a"])(this,"onMouseUp",()=>{this.isDrawing&&this.history.record(),this.isDrawing=!1}),this.canvas=t,this.history=e}}var f=d;class v{constructor(t,e){Object(h["a"])(this,"isDrawing",!1),Object(h["a"])(this,"strokeWidth",u.strokeWidth),Object(h["a"])(this,"strokeColor",u.strokeColor),Object(h["a"])(this,"fillColor",u.fillColor),Object(h["a"])(this,"init",()=>this.initEvent()),Object(h["a"])(this,"initEvent",()=>(this.canvas.on("mouse:down",this.onMouseDown),this.canvas.on("mouse:move",this.onMouseMove),this.canvas.on("mouse:up",this.onMouseUp),()=>{this.canvas.off("mouse:down",this.onMouseDown),this.canvas.off("mouse:move",this.onMouseMove),this.canvas.off("mouse:up",this.onMouseUp)})),Object(h["a"])(this,"onMouseDown",t=>{if(t.target)return;this.isDrawing=!0;let e=this.canvas.getPointer(t.e);this.startX=e.x,this.startY=e.y;let i=new l["fabric"].Ellipse({...u.circle,...u.controls,left:this.startX,top:this.startY,originX:"left",originY:"top",rx:e.x-this.startX,ry:e.y-this.startY,stroke:this.strokeColor,strokeWidth:this.strokeWidth,fill:this.fillColor});i.setControlVisible("mtr",!1),this.canvas.add(i),this.curCircle=i}),Object(h["a"])(this,"onMouseMove",t=>{if(!this.isDrawing)return;let e=this.canvas.getPointer(t.e);this.startX>e.x&&this.curCircle.set({left:Math.abs(e.x)}),this.startY>e.y&&this.curCircle.set({top:Math.abs(e.y)}),this.curCircle.set({rx:Math.abs(this.startX-e.x)/2}),this.curCircle.set({ry:Math.abs(this.startY-e.y)/2}),this.curCircle.setCoords(),this.canvas.renderAll()}),Object(h["a"])(this,"onMouseUp",()=>{this.isDrawing&&this.history.record(),this.isDrawing=!1}),this.canvas=t,this.history=e}}var g=v;class p{constructor(t,e){Object(h["a"])(this,"fontsize",u.fontsize),Object(h["a"])(this,"fontcolor",u.strokeColor),Object(h["a"])(this,"init",()=>this.initEvent()),Object(h["a"])(this,"initEvent",()=>(this.canvas.on("mouse:down",this.onMouseDown),()=>{this.canvas.off("mouse:down",this.onMouseDown)})),Object(h["a"])(this,"blur",()=>{this.curText&&(this.curText.exitEditing(),this.curText.hiddenTextarea&&this.curText.hiddenTextarea.blur()),this.activeText&&(this.activeText.exitEditing(),this.activeText.hiddenTextarea&&this.activeText.hiddenTextarea.blur())}),Object(h["a"])(this,"onMouseDown",t=>{let e=this;if(this.curText&&this.curText!==t.target&&(this.curText.exitEditing(),this.curText.hiddenTextarea&&this.curText.hiddenTextarea.blur()),this.curText===t.target&&(this.curText.setCursorByClick(t),this.curText.restartCursorIfNeeded()),!t.target){let i=this.canvas.getPointer(t.e);this.startX=i.x,this.startY=i.y;let n=new l["fabric"].IText("",{...u.text,...u.controls,left:this.startX,top:this.startY,originX:"left",originY:"top",fontSize:this.fontsize,fill:this.fontcolor});this.canvas.add(n),n.setControlVisible("mtr",!1),n.enterEditing(),n.hiddenTextarea.focus(),n.on("editing:entered",(function(){e.activeText=this})),n.on("editing:exited",()=>{this.history.record()}),this.curText=n}}),this.canvas=t,this.history=e}}var m=p;class b{constructor(t,e){Object(h["a"])(this,"strokeWidth",u.strokeWidth),Object(h["a"])(this,"strokeColor",u.strokeColor),Object(h["a"])(this,"init",()=>(this.canvas.isDrawingMode=!0,this.canvas.freeDrawingBrush.width=this.strokeWidth,this.canvas.freeDrawingBrush.color=this.strokeColor,this.canvas.on("path:created",this.handleConfigureLine),()=>{this.canvas.isDrawingMode=!1,this.canvas.off("path:created",this.handleConfigureLine)})),Object(h["a"])(this,"handleConfigureLine",t=>{let e={...u.controls,...u.line};if(t.path){for(let i in e)t.path[i]=e[i];t.path.setControlVisible("mtr",!1),this.history.record()}}),this.canvas=t,this.history=e}}var w=b;class x{constructor(t){Object(h["a"])(this,"undoStack",[]),Object(h["a"])(this,"initEvent",()=>{this.canvas.on("object:modified",this.record)}),Object(h["a"])(this,"record",()=>{this.undoStack.push(this.canvas.toJSON(["transparentCorners","hasBorders","cornerStyle","padding","cornerSize","cornerColor","cornerStrokeColor","borderOpacityWhenMoving"])),this.prevAction="record",this.watchCb&&this.watchCb(this.canUndo())}),Object(h["a"])(this,"undo",()=>{if("record"===this.prevAction&&this.undoStack.pop(),this.undoStack.length){let t=this.undoStack.pop();this.canvas.loadFromJSON(t)}else this.canvas.clear();this.prevAction="undo",this.watchCb&&this.watchCb(this.canUndo())}),Object(h["a"])(this,"canUndo",()=>this.undoStack.length>0),Object(h["a"])(this,"watch",t=>{this.watchCb=t}),this.canvas=t,this.initEvent()}}var y=x;class C{constructor(t,e){Object(h["a"])(this,"initEvent",()=>{this.canvas.on("selection:created",t=>{t.target&&t.target.setControlVisible("mtr",!1)})}),Object(h["a"])(this,"getImage",t=>new Promise(e=>{let i=new Image;i.src=this.imgBase64;let n=new l["fabric"].Image(i);n.set({scaleX:t,scaleY:t,originX:"left",originY:"top"}),this.canvas.setBackgroundImage(n,()=>{let t=this.canvas.toDataURL();e(t)})})),this.canvas=new l["fabric"].Canvas(t,{...u.canvas}),this.imgBase64=e,this.history=new y(this.canvas),this.rect=new f(this.canvas,this.history),this.circle=new g(this.canvas,this.history),this.text=new m(this.canvas,this.history),this.freedraw=new w(this.canvas,this.history),this.initEvent()}clearPrevBrush(){this.text.blur(),this.fnClearPrevBrush&&this.fnClearPrevBrush()}drawRect(){this.clearPrevBrush(),this.fnClearPrevBrush=this.rect.init()}drawCircle(){this.clearPrevBrush(),this.fnClearPrevBrush=this.circle.init()}drawText(){this.clearPrevBrush(),this.fnClearPrevBrush=this.text.init()}drawLine(){this.clearPrevBrush(),this.fnClearPrevBrush=this.freedraw.init()}}var O=C,_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("draggable",{ref:"draggable",staticClass:"imgdw-toolbar"},[i("brush",{attrs:{curBrush:t.curBrush},on:{onSelectBrush:t.handleSelectBrush}}),i("div",{staticClass:"imgdw-split-line"}),i("icon",{staticClass:"imgdw-btn imgdw-btn-undo",attrs:{icon:"icon-chexiao"},nativeOn:{click:function(e){return e.stopPropagation(),t.handleUndo.apply(null,arguments)}}}),i("icon",{staticClass:"imgdw-btn imgdw-btn-narrow",attrs:{icon:"icon-suoxiao"},nativeOn:{click:function(e){return e.stopPropagation(),t.handleScale("narrow")}}}),i("icon",{staticClass:"imgdw-btn imgdw-btn-enlarge",attrs:{icon:"icon-fangda"},nativeOn:{click:function(e){return e.stopPropagation(),t.handleScale("enlarge")}}}),i("icon",{staticClass:"imgdw-btn imgdw-btn-cancel",attrs:{icon:"icon-guanbi"},nativeOn:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}}),i("icon",{staticClass:"imgdw-btn imgdw-btn-confirm",attrs:{icon:"icon-duigou"},nativeOn:{click:function(e){return e.stopPropagation(),t.handleConfirm.apply(null,arguments)}}})],1)},j=[],M=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{staticClass:"imgdw-icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#"+t.icon}})])},k=[],S=(i("2ca0"),{props:{icon:String}}),B=S,T=i("2877");function D(t){var e=i("48f9");e.__inject__&&e.__inject__(t)}var z=Object(T["a"])(B,M,k,!1,D,"25f36dac",null,!0),P=z.exports,E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"draggable",staticClass:"imgdw-draggable",style:{top:t.position.y+"px",left:t.position.x+"px"},on:{mousedown:t.handleDragStart,mouseup:t.handleDragEnd}},[t._t("default")],2)},L=[],$={name:"imgdwDraggable",data(){return{position:{x:0,y:0}}},methods:{initPosition(){let t=this.$refs.draggable.clientWidth,e=this.$refs.draggable.clientHeight,i=window.innerWidth,n=window.innerHeight;this.position.x=i-t-50,this.position.y=n-e-50},handleDragStart(t){this.subX=t.pageX-this.$refs.draggable.offsetLeft,this.subY=t.pageY-this.$refs.draggable.offsetTop,document.addEventListener("mousemove",this.handleMouseMove)},handleDragEnd(){document.removeEventListener("mousemove",this.handleMouseMove)},handleMouseMove(t){this.position={x:t.pageX-this.subX,y:t.pageY-this.subY}}}},U=$;function X(t){var e=i("f086");e.__inject__&&e.__inject__(t)}var Y=Object(T["a"])(U,E,L,!1,X,"54f719ae",null,!0),R=Y.exports,W=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"imgdw-brush"},t._l(t.brushList,(function(e){return i("icon",{key:e.name,staticClass:"imgdw-brush-btn",class:{"imgdw-brush-btn-active":t.curBrush===e.name},attrs:{icon:e.icon},nativeOn:{click:function(i){return i.stopPropagation(),t.handleSelectBrush(e.name)}}})})),1)},I=[],A=[{name:"rect",icon:"icon-juxing"},{name:"circle",icon:"icon-tuoyuan"},{name:"line",icon:"icon-huabi"},{name:"text",icon:"icon-wenzi"}],H={name:"imgdwBrush",components:{icon:P},props:{curBrush:String},data(){return{brushList:A}},methods:{handleSelectBrush(t){this.curBrush!==t&&this.$emit("onSelectBrush",t)}}},V=H;function F(t){var e=i("4894");e.__inject__&&e.__inject__(t)}var N=Object(T["a"])(V,W,I,!1,F,"3fb94197",null,!0),J=N.exports,q={name:"imgdwToolbar",components:{icon:P,draggable:R,brush:J},props:{canvasScale:Number,curBrush:String},methods:{initPosition(){this.$refs.draggable.initPosition()},handleSelectBrush(t){this.$emit("onSelectBrush",t)},handleUndo(){this.$emit("onUndo")},handleScale(t){"enlarge"===t&&this.canvasScale<2&&this.$emit("onScale",parseFloat((this.canvasScale+.1).toFixed(1))),"narrow"===t&&this.canvasScale>.1&&this.$emit("onScale",parseFloat((this.canvasScale-.1).toFixed(1)))},handleCancel(){this.$emit("onCancel")},handleConfirm(){this.$emit("onConfirm")}}},G=q;function K(t){var e=i("690a");e.__inject__&&e.__inject__(t)}var Q=Object(T["a"])(G,_,j,!1,K,"b6242140",null,!0),Z=Q.exports;i("219c");async function tt(t){const e=await fetch(t),i=await e.blob();return i}async function et(t){return new Promise(e=>{const i=new FileReader;i.onload=t=>{e(t.target.result)},i.readAsDataURL(t)})}function it(t){let e=t.split(","),i=e[0].match(/:(.*?);/)[1],n=atob(e[1]),s=n.length,a=new Uint8Array(s);while(s--)a[s]=n.charCodeAt(s);return new File([a],"image.png",{type:i})}async function nt(t){return new Promise(e=>{let i=new Image;i.src=t,i.onload=()=>{let t=i.width,n=i.height;t>1080&&(n=parseInt(1080*n/t),t=1080),e({width:t,height:n,originalWidth:i.width,originalHeight:i.height,scale:t/i.width})}})}var st={name:"vueImageAnnotation",components:{Toolbar:Z},data:function(){return{visible:!1,saving:!1,size:null,drawer:null,curBrush:"",canvasScale:1,imgBase64:""}},methods:{initData:function(){var t=this;this.size=null,this.curBrush="",this.canvasScale=1,this.visible=!0,this.saving=!1,this.$nextTick((function(){t.$refs.toolbar.initPosition()}))},openUrl:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function i(){var n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.initData(),i.next=3,tt(t);case 3:return n=i.sent,i.next=6,et(n);case 6:return s=i.sent,i.next=9,nt(s);case 9:e.size=i.sent,e.imgBase64=s,e.$nextTick((function(){e.drawer=new O(e.$refs.canvas,s)}));case 12:case"end":return i.stop()}}),i)})))()},openBase64:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.initData(),i.next=3,nt(t);case 3:e.size=i.sent,e.imgBase64=t,e.$nextTick((function(){e.drawer=new O(e.$refs.canvas,t)}));case 6:case"end":return i.stop()}}),i)})))()},handleSelectBrush:function(t){switch(t){case"rect":this.drawer.drawRect();break;case"circle":this.drawer.drawCircle();break;case"text":this.drawer.drawText();break;case"line":this.drawer.drawLine();break}this.curBrush=t},handleUndo:function(){this.drawer.history.undo()},handleScale:function(t){this.canvasScale=t},handleCancel:function(){this.visible=!1},handleConfirm:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.saving){e.next=2;break}return e.abrupt("return");case 2:return t.saving=!0,e.next=5,t.drawer.getImage(t.size.scale);case 5:return i=e.sent,e.next=8,it(i);case 8:n=e.sent,t.visible=!1,t.$emit("onSave",i,n);case 11:case"end":return e.stop()}}),e)})))()}}},at=st,rt=(i("1bda"),Object(T["a"])(at,r,o,!1,null,"0b70da30",null)),ot=rt.exports,ct={name:"App",components:{ImageDrawer:ot},methods:{handleOpenDrawer:function(){this.$refs.refImageDrawer.openUrl("./img.jpeg")},handleSave:function(t,e){console.log(t),console.log(e)}}},ht=ct,lt=Object(T["a"])(ht,s,a,!1,null,null,null),ut=lt.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(ut)}}).$mount("#app")},"690a":function(t,e,i){"use strict";i.r(e);var n=i("4421");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s)},"723f":function(t,e,i){},eb5e:function(t,e,i){},f086:function(t,e,i){"use strict";i.r(e);var n=i("723f");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s)}});
//# sourceMappingURL=app.2dc07df6.js.map